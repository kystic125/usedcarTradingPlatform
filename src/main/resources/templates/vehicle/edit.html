<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Listing - SmartPick</title>

    <link rel="apple-touch-icon" sizes="180x180" th:href="@{/images/favicon/apple-touch-icon.png}">
    <link rel="icon" type="image/png" sizes="32x32" th:href="@{/images/favicon/favicon-32x32.png}">
    <link rel="icon" type="image/png" sizes="16x16" th:href="@{/images/favicon/favicon-16x16.png}">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Antonio:wght@100..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" th:href="@{/libs/owl.carousel/dist/assets/owl.carousel.min.css}">
    <link rel="stylesheet" th:href="@{/libs/owl.carousel/dist/assets/owl.theme.default.min.css}">
    <link rel="stylesheet" th:href="@{/libs/simplebar/dist/simplebar.min.css}">
    <noscript>
        <style>
            .simplebar-content-wrapper { scrollbar-width: auto; -ms-overflow-style: auto; }
            .simplebar-content-wrapper::-webkit-scrollbar, .simplebar-hide-scrollbar::-webkit-scrollbar { display: initial; width: initial; height: initial; }
        </style>
    </noscript>

    <link rel="stylesheet" th:href="@{/libs/jarallax/dist/jarallax.min.css}">
    <link rel="stylesheet" th:href="@{/css/style.min.css}">
    <link id="templateColorScheme" rel="stylesheet" th:href="@{/css/color-schemes/tc_red.css}">
    <link rel="stylesheet" th:href="@{/css/preloader.css}">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

    <script th:src="@{/js/preloader.js}"></script>

    <style>
        /* 드래그 앤 드롭 & 미리보기 스타일 */
        .upload-dropzone {
            border: 2px dashed #dee2e6;
            border-radius: 0.375rem;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
            cursor: pointer;
            position: relative;
        }
        .upload-dropzone:hover, .upload-dropzone.dragover {
            border-color: #dc3545;
            background-color: #fff5f5;
        }
        .preview-image-wrapper {
            width: 120px;
            height: 90px;
            position: relative;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .preview-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .btn-remove-image {
            position: absolute;
            top: 2px;
            right: 2px;
            background-color: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
        }
        .btn-remove-image:hover { background-color: #dc3545; }
        .thumbnail-badge {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 0.6rem;
            padding: 2px 4px;
            z-index: 5;
        }
    </style>
</head>

<body>

<div class="preloader">
    <div class="loader">
        <div class="loader-inner ball-scale-multiple">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>

<header th:replace="~{fragments/header :: main-header}"></header>

<div class="breadcrumb-style-1 bg-body-tertiary position-relative z-1 py-4">
    <div class="container d-lg-flex position-relative z-1 justify-content-between align-items-center py-2 py-lg-3">
        <div class="order-lg-1 pe-lg-4 text-center text-lg-start">
            <h3 class="h3 mb-3 mb-lg-0">Edit Listing</h3>
        </div>
        <div class="order-lg-2 mb-0">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb flex-lg-nowrap justify-content-center justify-content-lg-start m-0 fs-sm">
                    <li class="breadcrumb-item">
                        <a class="link-body-emphasis text-nowrap link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-50-hover" href="/">
                            <i class="bi bi-house-door me-1"></i>Home
                        </a>
                    </li>
                    <li class="breadcrumb-item">
                        <a class="link-body-emphasis text-nowrap link-offset-2 link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-50-hover" href="/company/sales">Listings</a>
                    </li>
                    <li class="breadcrumb-item text-nowrap active" aria-current="page">Edit Listing</li>
                </ol>
            </nav>
        </div>
    </div>
</div>

<main>
    <div class="container py-5 mb-md-4">
        <div class="row">

            <section class="col-12">
                <div class="card border-0">
                    <div class="card-body p-4">

                        <div class="mb-4 pb-2 border-bottom">
                            <h4 class="card-title fw-bold mb-1">Edit Vehicle</h4>
                            <p class="text-muted small mb-0">Update your vehicle information. <br> Uploading new photos will extend the expiration date.</p>
                        </div>

                        <div th:if="${param.error}" class="alert alert-danger d-flex align-items-center mb-4" role="alert">
                            <i class="bi bi-exclamation-triangle-fill me-2"></i>
                            <div>
                                Update failed. <br> <small th:text="${param.error}"></small>
                            </div>
                        </div>

                        <form th:action="@{/vehicles/{id}/edit(id=${car.vehicleId})}" method="post" enctype="multipart/form-data" id="listingForm">

                            <h5 class="fw-bold fs-6 mb-3 text-uppercase custom-color">Basic Information</h5>
                            <div class="row g-3 mb-4">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold small">Brand</label>
                                    <select name="brand" class="form-select custom-color" required>
                                        <option value="Hyundai" th:selected="${car.brand == 'Hyundai'}">Hyundai</option>
                                        <option value="Kia" th:selected="${car.brand == 'Kia'}">Kia</option>
                                        <option value="Genesis" th:selected="${car.brand == 'Genesis'}">Genesis</option>
                                        <option value="BMW" th:selected="${car.brand == 'BMW'}">BMW</option>
                                        <option value="Mercedes-Benz" th:selected="${car.brand == 'Mercedes-Benz'}">Mercedes-Benz</option>
                                        <option value="Audi" th:selected="${car.brand == 'Audi'}">Audi</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold small">Model</label>
                                    <input type="text" name="model" class="form-control custom-color" th:value="${car.model}" required>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small">Year</label>
                                    <input type="number" name="modelYear" class="form-control custom-color" th:value="${car.modelYear}" required>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small">Mileage (km)</label>
                                    <input type="number" name="mileage" class="form-control custom-color" th:value="${car.mileage}" required>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small">Price (KRW)</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-light">₩</span>
                                        <input type="number" name="price" class="form-control custom-color" th:value="${car.price}" required>
                                    </div>
                                </div>
                            </div>

                            <h5 class="fw-bold fs-6 mb-3 text-uppercase custom-color pt-3 border-top">Specifications</h5>
                            <div class="row g-3 mb-4">
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small">Fuel Type</label>
                                    <select name="fuelType" class="form-select custom-color" required>
                                        <option value="GASOLINE" th:selected="${car.fuelType.name() == 'GASOLINE'}">Gasoline</option>
                                        <option value="DIESEL" th:selected="${car.fuelType.name() == 'DIESEL'}">Diesel</option>
                                        <option value="ELECTRIC" th:selected="${car.fuelType.name() == 'ELECTRIC'}">Electric</option>
                                        <option value="HYBRID" th:selected="${car.fuelType.name() == 'HYBRID'}">Hybrid</option>
                                        <option value="LPG" th:selected="${car.fuelType.name() == 'LPG'}">LPG</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small">Transmission</label>
                                    <select name="transmission" class="form-select custom-color" required>
                                        <option value="AUTO" th:selected="${car.transmission.name() == 'AUTO'}">Automatic</option>
                                        <option value="MANUAL" th:selected="${car.transmission.name() == 'MANUAL'}">Manual</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small">Color</label>
                                    <input type="text" name="color" class="form-control custom-color" th:value="${car.color}" required>
                                </div>
                                <div class="col-12">
                                    <label class="form-label fw-bold small">Accident History</label>
                                    <div class="d-flex gap-4">
                                        <div class="form-check">
                                            <input class="form-check-input custom-color" type="radio" name="accidentHistory" id="accNo" value="false" th:checked="${!car.accidentHistory}">
                                            <label class="form-check-label" for="accNo">No Accident</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input custom-color" type="radio" name="accidentHistory" id="accYes" value="true" th:checked="${car.accidentHistory}">
                                            <label class="form-check-label text-danger" for="accYes">Has Accident</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <h5 class="fw-bold fs-6 mb-3 text-uppercase custom-color pt-3 border-top">Features & Options</h5>
                            <div class="row row-cols-2 row-cols-md-4 g-3 mb-4">
                                <div class="col" th:each="opt : ${ {'Sunroof', 'Navigation', 'Heated Seats', 'Ventilated Seats', 'HUD', 'Leather Seats', 'Rear Camera', 'Smart Key'} }">
                                    <div class="form-check">
                                        <input class="form-check-input custom-color" type="checkbox" name="options" th:value="${opt}" th:id="${'opt-' + opt}"
                                               th:checked="${car.options != null && #strings.contains(car.options, opt)}">
                                        <label class="form-check-label small" th:for="${'opt-' + opt}" th:text="${opt}"></label>
                                    </div>
                                </div>
                            </div>

                            <h5 class="fw-bold fs-6 mb-3 text-uppercase custom-color pt-3 border-top">Photos (Update)</h5>
                            <div class="mb-4">
                                <div class="mb-3" th:if="${!#lists.isEmpty(car.images)}">
                                    <label class="form-label fw-bold small text-muted">Current Images</label>
                                    <div class="d-flex gap-2 overflow-auto" id="current-images-container">
                                        <div class="position-relative border rounded" th:each="img : ${car.images}" style="width: 100px; height: 75px; flex-shrink: 0;">
                                            <img th:src="${img.imageUrl}" class="w-100 h-100 object-fit-cover rounded">
                                        </div>
                                    </div>
                                    <div class="form-text small text-warning">
                                        <i class="bi bi-info-circle"></i> If you upload new images, these current images will be replaced.
                                    </div>
                                </div>

                                <label class="form-label fw-bold small">Upload New Images</label>
                                <div class="upload-dropzone p-5 text-center position-relative" id="dropZone">
                                    <input type="file" name="imageFiles" id="imageInput" class="position-absolute top-0 start-0 w-100 h-100 opacity-0" multiple accept="image/*">
                                    <div class="text-muted pointer-events-none">
                                        <i class="bi bi-cloud-arrow-up display-4 mb-3 d-block text-secondary"></i>
                                        <h6 class="fw-bold text-dark">Drop NEW files to replace</h6>
                                        <p class="small mb-0">Uploading new files will update expiration date.</p>
                                    </div>
                                </div>
                                <div id="previewContainer" class="d-flex gap-2 mt-3 flex-wrap"></div>
                            </div>

                            <div class="mb-4">
                                <label class="form-label fw-bold small">Description</label>
                                <textarea name="description" class="form-control custom-color" rows="5" th:text="${car.description}"></textarea>
                            </div>

                            <div class="d-grid d-md-flex justify-content-md-end gap-2 pt-3 border-top">
                                <a href="/company/sales" class="btn btn-light border fw-bold px-4">Cancel</a>
                                <button type="button" class="btn btn-info text-white fw-bold px-4" onclick="showPreview()">
                                    <i class="bi bi-eye me-2"></i> Preview
                                </button>
                                <button type="button" class="btn btn-primary custom-color fw-bold px-5" onclick="submitFormWithValidation()">Update Listing</button>
                            </div>

                        </form>
                    </div>
                </div>
            </section>

        </div>
    </div>
</main>

<footer th:replace="~{fragments/footer :: main-footer}"></footer>

<script th:src="@{/libs/jquery/dist/jquery.min.js}"></script>
<script th:src="@{/libs/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/libs/simplebar/dist/simplebar.min.js}"></script>
<script th:src="@{/libs/jarallax/dist/jarallax.min.js}"></script>
<script th:src="@{/js/script.min.js}"></script>

<script th:inline="javascript">
    /*<![CDATA[*/
    const currentCompanyName = /*[[${user.company != null ? user.company.businessName : user.name}]]*/ 'My Company';

    const existingImages = [];
    /*[# th:each="img : ${car.images}"]*/
        existingImages.push({
            imageUrl: /*[[${img.imageUrl}]]*/ ''
        });
    /*[/]*/
    /*]]>*/

    const imageInput = document.getElementById('imageInput');
    const previewContainer = document.getElementById('previewContainer');
    const dropZone = document.getElementById('dropZone');
    const dataTransfer = new DataTransfer();

    // === 파일 처리 (register.html과 동일) ===
    imageInput.addEventListener('change', function(e) { handleFiles(e.target.files); });
    ['dragenter', 'dragover'].forEach(n => dropZone.addEventListener(n, (e) => {e.preventDefault(); dropZone.classList.add('dragover');}, false));
    ['dragleave', 'drop'].forEach(n => dropZone.addEventListener(n, (e) => {e.preventDefault(); dropZone.classList.remove('dragover');}, false));
    dropZone.addEventListener('drop', (e) => handleFiles(e.dataTransfer.files));

    function handleFiles(files) {
        if(files && files.length > 0){
            for(let i=0; i<files.length; i++) dataTransfer.items.add(files[i]);
            imageInput.files = dataTransfer.files;
            renderPreviews();
        }
    }

    function renderPreviews() {
        previewContainer.innerHTML = '';
        if (dataTransfer.files.length === 0) return;

        Array.from(dataTransfer.files).forEach((file, index) => {
            const reader = new FileReader();
            reader.onload = function(e) {
                const div = document.createElement('div');
                div.className = 'preview-image-wrapper';
                div.innerHTML = `<img src="${e.target.result}">
                                 <button type="button" class="btn-remove-image" onclick="removeFile(${index})"><i class="bi bi-x"></i></button>`;
                previewContainer.appendChild(div);
            }
            reader.readAsDataURL(file);
        });
    }

    function removeFile(index) {
        const newDt = new DataTransfer();
        for(let i=0; i<dataTransfer.files.length; i++) if(i!==index) newDt.items.add(dataTransfer.files[i]);
        dataTransfer.items.clear();
        for(let i=0; i<newDt.files.length; i++) dataTransfer.items.add(newDt.files[i]);
        imageInput.files = dataTransfer.files;
        renderPreviews();
    }

    function submitFormWithValidation() {
        const form = document.getElementById('listingForm');
        if (form.checkValidity()) form.submit();
        else {
            const modalEl = document.getElementById('previewModal');
            const modal = bootstrap.Modal.getInstance(modalEl);
            if(modal) modal.hide();
            setTimeout(() => form.reportValidity(), 300);
        }
    }

    // === 미리보기 로직 (Edit 버전) ===
    function showPreview() {
        // 텍스트 값 매핑 (동일)
        const brand = document.querySelector('select[name="brand"]').value;
        const model = document.querySelector('input[name="model"]').value;
        const price = document.querySelector('input[name="price"]').value;
        const year = document.querySelector('input[name="modelYear"]').value;
        const mileage = document.querySelector('input[name="mileage"]').value;
        const fuel = document.querySelector('select[name="fuelType"]').value;
        const trans = document.querySelector('select[name="transmission"]').value;
        const color = document.querySelector('input[name="color"]').value;
        const desc = document.querySelector('textarea[name="description"]').value;

        const accInput = document.querySelector('input[name="accidentHistory"]:checked');
        const accident = accInput ? (accInput.value === 'true' ? 'Yes' : 'No') : 'No';

        // 텍스트 채우기
        document.getElementById('prev-title').innerText = `${brand} ${model}`;
        document.getElementById('prev-price').innerText = price ? Number(price).toLocaleString() + ' 원' : '0 원';
        document.getElementById('prev-year').innerText = year;
        document.getElementById('prev-mileage').innerText = mileage ? Number(mileage).toLocaleString() + ' km' : '-';
        document.getElementById('prev-fuel').innerText = fuel;
        document.getElementById('prev-trans').innerText = trans;
        document.getElementById('prev-color').innerText = color;
        document.getElementById('prev-accident').innerText = accident;
        document.getElementById('prev-seller').innerText = currentCompanyName;
        document.getElementById('prev-desc').innerText = desc;

        // Spec 리스트 채우기
        document.getElementById('feat-brand').innerText = brand;
        document.getElementById('feat-model').innerText = model;
        document.getElementById('feat-year').innerText = year;
        document.getElementById('feat-fuel').innerText = fuel;
        document.getElementById('feat-trans').innerText = trans;
        document.getElementById('feat-color').innerText = color;
        document.getElementById('feat-mileage').innerText = mileage ? Number(mileage).toLocaleString() + ' km' : '-';
        document.getElementById('feat-accident').innerText = accident;

        // 옵션 리스트
        const optionsList = document.getElementById('prev-options-list');
        optionsList.innerHTML = '';
        document.querySelectorAll('input[name="options"]:checked').forEach(opt => {
            const li = document.createElement('li');
            li.className = 'list-group-item col border-0 custom-color';
            li.innerHTML = `<i class="bi bi-check-circle-fill text-success me-2"></i> ${opt.value}`;
            optionsList.appendChild(li);
        });

        // === 이미지 처리 (Edit 로직의 핵심) ===
        const mainImg = document.getElementById('prev-main-img');
        const thumbContainer = document.getElementById('prev-thumbnails');
        thumbContainer.innerHTML = '';

        // A. 새 파일이 있으면 그것을 우선 보여줌
        if (dataTransfer.files.length > 0) {
            // 메인
            const reader = new FileReader();
            reader.onload = e => mainImg.src = e.target.result;
            reader.readAsDataURL(dataTransfer.files[0]);

            // 썸네일
            Array.from(dataTransfer.files).forEach(file => {
                const r = new FileReader();
                r.onload = e => createThumbnail(e.target.result, thumbContainer, mainImg);
                r.readAsDataURL(file);
            });
        }
        // B. 새 파일이 없으면 기존 DB 이미지 보여줌
        else if (existingImages && existingImages.length > 0) {
            mainImg.src = existingImages[0].imageUrl;
            existingImages.forEach(img => {
                createThumbnail(img.imageUrl, thumbContainer, mainImg);
            });
        }
        // C. 둘 다 없으면 기본 이미지
        else {
            mainImg.src = '/images/default-car.jpg';
        }

        const myModal = new bootstrap.Modal(document.getElementById('previewModal'));
        myModal.show();
    }

    // 썸네일 생성 헬퍼 함수
    function createThumbnail(src, container, mainImgEl) {
        const img = document.createElement('img');
        img.src = src;
        img.className = 'img-fluid rounded-2 object-fit-cover border me-2';
        img.style.width = '100px';
        img.style.height = '75px';
        img.style.cursor = 'pointer';
        img.onclick = () => mainImgEl.src = src;
        container.appendChild(img);
    }
</script>

<div class="modal fade" id="previewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header border-bottom-0 pb-0">
                <h5 class="modal-title fw-bold">Preview Listing (Updated)</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body bg-body p-4">
                <div class="container car-details p-0">

                    <div class="row mb-4">
                        <div class="col-lg-8 pb-4 pb-lg-0">
                            <div class="h-100 car-title bg-body-tertiary border rounded-2 p-3 position-relative">
                                <h1 class="fw-bold car-name fs-special fs-2 p-0 m-0 text-body-emphasis" id="prev-title">Title</h1>
                                <div class="mt-3 fs-sm">
                                    <span class="badge text-bg-warning rounded-1 me-1">Update Pending</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="h-100 bg-body-tertiary border rounded-2 p-3 d-flex justify-content-between align-items-center">
                                <span class="price-text d-block fs-2">Price</span>
                                <span class="price-val d-block fs-special fs-2 fw-bold text-primary custom-color" id="prev-price">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-8">
                            <div class="car-photos mb-4 pb-3 position-relative">
                                <div class="rounded-2 overflow-hidden mb-2 border">
                                    <img id="prev-main-img" class="img-fluid object-fit-cover w-100" style="height: 450px;" src="" alt="">
                                </div>
                                <div id="prev-thumbnails" class="d-flex overflow-auto py-2" style="white-space: nowrap;"></div>
                            </div>

                            <div class="car-description mb-4 pb-3">
                                <h2 class="fs-special fw-bold">Description</h2>
                                <p id="prev-desc" style="white-space: pre-line;" class="text-body-secondary"></p>
                            </div>

                            <div class="car-features mb-4 pb-3">
                                <h2 class="fs-special fw-bold">Features</h2>
                                <div class="accordion" id="prevAccordion">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button fs-5 fw-bold custom-color" type="button" data-bs-toggle="collapse" data-bs-target="#prevExterior">General Features</button>
                                        </h2>
                                        <div id="prevExterior" class="accordion-collapse collapse show" data-bs-parent="#prevAccordion">
                                            <div class="accordion-body">
                                                <ul class="list-group list-group-horizontal list-group-flush row row-cols-1 row-cols-md-2 border-0">
                                                    <li class="list-group-item col border-0 custom-color"><strong>Brand: </strong> <span id="feat-brand"></span></li>
                                                    <li class="list-group-item col border-0 custom-color"><strong>Model: </strong> <span id="feat-model"></span></li>
                                                    <li class="list-group-item col border-0 custom-color"><strong>Year: </strong> <span id="feat-year"></span></li>
                                                    <li class="list-group-item col border-0 custom-color"><strong>Fuel: </strong> <span id="feat-fuel"></span></li>
                                                    <li class="list-group-item col border-0 custom-color"><strong>Trans: </strong> <span id="feat-trans"></span></li>
                                                    <li class="list-group-item col border-0 custom-color"><strong>Color: </strong> <span id="feat-color"></span></li>
                                                    <li class="list-group-item col border-0 custom-color"><strong>Mileage: </strong> <span id="feat-mileage"></span></li>
                                                    <li class="list-group-item col border-0 custom-color"><strong>Accident: </strong> <span id="feat-accident"></span></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button fs-5 fw-bold custom-color collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#prevInterior">Vehicle Options</button>
                                        </h2>
                                        <div id="prevInterior" class="accordion-collapse collapse" data-bs-parent="#prevAccordion">
                                            <div class="accordion-body">
                                                <ul class="list-group list-group-horizontal list-group-flush row row-cols-1 row-cols-md-2 border-0" id="prev-options-list"></ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="sticky-top">
                                <div class="card border">
                                    <div class="card-body"><h5 class="fw-bold fs-special fs-4 mb-1">Overview</h5></div>
                                    <ul class="list-group list-group-flush m-3 border-0 my-0">
                                        <li class="list-group-item d-flex justify-content-between list-group-item-light border mb-1 rounded-1"><span>Year</span><span class="fw-bold" id="prev-year"></span></li>
                                        <li class="list-group-item d-flex justify-content-between list-group-item-light border mb-1 rounded-1"><span>Mileage</span><span class="fw-bold" id="prev-mileage"></span></li>
                                        <li class="list-group-item d-flex justify-content-between list-group-item-light border mb-1 rounded-1"><span>Fuel</span><span class="fw-bold" id="prev-fuel"></span></li>
                                        <li class="list-group-item d-flex justify-content-between list-group-item-light border mb-1 rounded-1"><span>Trans</span><span class="fw-bold" id="prev-trans"></span></li>
                                        <li class="list-group-item d-flex justify-content-between list-group-item-light border mb-1 rounded-1"><span>Color</span><span class="fw-bold" id="prev-color"></span></li>
                                        <li class="list-group-item d-flex justify-content-between list-group-item-light border mb-1 rounded-1"><span>Accident</span><span class="fw-bold" id="prev-accident"></span></li>
                                        <li class="list-group-item d-flex justify-content-between list-group-item-light border mb-1 rounded-1"><span>Seller</span><span class="fw-bold" id="prev-seller"></span></li>
                                    </ul>
                                    <div class="card-body text-center text-muted small">Action available after update.</div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="modal-footer bg-light border-top-0">
                <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">Edit More</button>
                <button type="button" class="btn btn-primary custom-color px-4 fw-bold" onclick="submitFormWithValidation()">Confirm & Update</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>